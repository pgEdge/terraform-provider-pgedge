---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "pgedge Provider"
subcategory: ""
description: |-
  The official Terraform provider for pgEdge Cloud https://www.pgedge.com/cloud, designed to simplify the management of pgEdge Cloud resources for both Developer and Enterprise edition.
  Authentication
  Before using the provider, you must create an API Client in pgEdge Cloud https://app.pgedge.com and configure the following environment variables:
  
  export PGEDGE_CLIENT_ID="your-client-id"
  export PGEDGE_CLIENT_SECRET="your-client-secret"
  
  These credentials authenticate the Terraform provider with your pgEdge Cloud account.
  Example Usage
  Developer Edition Configuration
  For Developer Edition, pgEdge offers access to manage databases. Here's an example setup for Developer Edition:
  
  terraform {
    required_providers {
      pgedge = {
        source = "pgEdge/pgedge"
      }
    }
  }
  
  provider "pgedge" {}
  
  # Define a database
  resource "pgedge_database" "defaultdb" {
    name       = "defaultdb"
    cluster_id = "f12239ddq-df9d-4ded-adqwead9-3e2bvhe6d6ee"
  
    options = [
      "rest:enabled",
      "install:northwind"
    ]
  }
  
  Enterprise Edition Configuration
  Enterprise Edition users can manage Cloud Accounts, SSH keys, Backup Stores, and Clusters. Here's an Enterprise Edition example:
  
  terraform {
    required_providers {
      pgedge = {
        source = "pgEdge/pgedge"
      }
    }
  }
  
  provider "pgedge" {
    base_url = "https://api.pgedge.com"
  }
  
  # SSH Key resource
  resource "pgedge_ssh_key" "example" {
    name       = "example-key"
    public_key = "ssh-ed25519 AAAAC3NzaC1wes241mmT63i04t5fvvsdwqVG7DkyxvyXbYQNhKP/rSeLY user@example.com"
  }
  
  # Cloud Account resource
  resource "pgedge_cloud_account" "example" {
    name        = "my-aws-account"
    type        = "aws"
    description = "My AWS Cloud Account"
  
    credentials = {
      role_arn = "arn:aws:iam::0123456789:role/pgedge-13fe3332c"
    }
  
    depends_on = [pgedge_ssh_key.example]
  }
  
  # Backup Store resource
  resource "pgedge_backup_store" "test_store" {
    name             = "test-store"
    cloud_account_id = pgedge_cloud_account.example.id
    region           = "us-east-1"
  
    depends_on = [pgedge_cloud_account.example]
  }
  
  # Cluster resource
  resource "pgedge_cluster" "example" {
    name             = "example"
    cloud_account_id = pgedge_cloud_account.example.id
    regions          = ["us-west-2", "us-east-1", "eu-central-1"]
    ssh_key_id       = pgedge_ssh_key.example.id
    backup_store_ids = [pgedge_backup_store.test_store.id]
    node_location    = "public"
  
    nodes = [
      {
        name          = "n1"
        region        = "us-west-2"
        instance_type = "r6g.medium"
        volume_size   = 100
        volume_type   = "gp2"
      },
      {
        name          = "n2"
        region        = "us-east-1"
        instance_type = "r6g.medium"
        volume_size   = 100
        volume_type   = "gp2"
      },
      {
        name          = "n3"
        region        = "eu-central-1"
        instance_type = "r6g.medium"
        volume_size   = 100
        volume_type   = "gp2"
      }
    ]
  
    networks = [
      {
        region         = "us-west-2"
        cidr           = "10.1.0.0/16"
        public_subnets = ["10.1.0.0/24"]
      },
      {
        region         = "us-east-1"
        cidr           = "10.2.0.0/16"
        public_subnets = ["10.2.0.0/24"]
      },
      {
        region         = "eu-central-1"
        cidr           = "10.3.0.0/16"
        public_subnets = ["10.3.0.0/24"]
      }
    ]
  
    firewall_rules = [
      {
        name    = "postgres"
        port    = 5432
        sources = ["192.0.2.44/32"]
      },
    ]
  
    depends_on = [pgedge_cloud_account.example]
  }
  
  # Database Resource
  resource "pgedge_database" "example_db" {
    name       = "exampledb"
    cluster_id = pgedge_cluster.example.id
  
    options = [
      "autoddl:enabled",
    ]
  
    extensions = {
      auto_manage = true
      requested = [
        "postgis",
        "vector"
      ]
    }
  
    nodes = {
      n1 = {
        name = "n1"
      },
      n2 = {
        name = "n2"
      },
      n3 = {
        name = "n3"
      }
    }
  
    backups = {
      provider = "pgbackrest"
      config = [
        {
          id        = "default"
          schedules = [
            {
              type            = "full"
              cron_expression = "0 6 * * ?"
              id              = "daily-full-backup"
            },
            {
              type            = "incr"
              cron_expression = "0 * * * ?"
              id              = "hourly-incr-backup"
            }
          ]
        }
      ]
    }
  
    depends_on = [pgedge_cluster.example]
  }
  
  For more information on the available resources and their configurations, please refer to the documentation for each resource and data source.
---

# pgedge Provider

The official Terraform provider for [pgEdge Cloud](https://www.pgedge.com/cloud), designed to simplify the management of pgEdge Cloud resources for both **Developer** and **Enterprise** edition.

## Authentication

Before using the provider, you must create an API Client in [pgEdge Cloud](https://app.pgedge.com) and configure the following environment variables:

```sh
export PGEDGE_CLIENT_ID="your-client-id"
export PGEDGE_CLIENT_SECRET="your-client-secret"
```

These credentials authenticate the Terraform provider with your pgEdge Cloud account.

## Example Usage

### Developer Edition Configuration

For Developer Edition, pgEdge offers access to manage databases. Here's an example setup for Developer Edition:

```hcl
terraform {
  required_providers {
    pgedge = {
      source = "pgEdge/pgedge"
    }
  }
}

provider "pgedge" {}

# Define a database
resource "pgedge_database" "defaultdb" {
  name       = "defaultdb"
  cluster_id = "f12239ddq-df9d-4ded-adqwead9-3e2bvhe6d6ee"

  options = [
    "rest:enabled",
    "install:northwind"
  ]
}
```

### Enterprise Edition Configuration

Enterprise Edition users can manage Cloud Accounts, SSH keys, Backup Stores, and Clusters. Here's an Enterprise Edition example:

```hcl
terraform {
  required_providers {
    pgedge = {
      source = "pgEdge/pgedge"
    }
  }
}

provider "pgedge" {
  base_url = "https://api.pgedge.com"
}

# SSH Key resource
resource "pgedge_ssh_key" "example" {
  name       = "example-key"
  public_key = "ssh-ed25519 AAAAC3NzaC1wes241mmT63i04t5fvvsdwqVG7DkyxvyXbYQNhKP/rSeLY user@example.com"
}

# Cloud Account resource
resource "pgedge_cloud_account" "example" {
  name        = "my-aws-account"
  type        = "aws"
  description = "My AWS Cloud Account"

  credentials = {
    role_arn = "arn:aws:iam::0123456789:role/pgedge-13fe3332c"
  }

  depends_on = [pgedge_ssh_key.example]
}

# Backup Store resource
resource "pgedge_backup_store" "test_store" {
  name             = "test-store"
  cloud_account_id = pgedge_cloud_account.example.id
  region           = "us-east-1"

  depends_on = [pgedge_cloud_account.example]
}

# Cluster resource
resource "pgedge_cluster" "example" {
  name             = "example"
  cloud_account_id = pgedge_cloud_account.example.id
  regions          = ["us-west-2", "us-east-1", "eu-central-1"]
  ssh_key_id       = pgedge_ssh_key.example.id
  backup_store_ids = [pgedge_backup_store.test_store.id]
  node_location    = "public"

  nodes = [
    {
      name          = "n1"
      region        = "us-west-2"
      instance_type = "r6g.medium"
      volume_size   = 100
      volume_type   = "gp2"
    },
    {
      name          = "n2"
      region        = "us-east-1"
      instance_type = "r6g.medium"
      volume_size   = 100
      volume_type   = "gp2"
    },
    {
      name          = "n3"
      region        = "eu-central-1"
      instance_type = "r6g.medium"
      volume_size   = 100
      volume_type   = "gp2"
    }
  ]

  networks = [
    {
      region         = "us-west-2"
      cidr           = "10.1.0.0/16"
      public_subnets = ["10.1.0.0/24"]
    },
    {
      region         = "us-east-1"
      cidr           = "10.2.0.0/16"
      public_subnets = ["10.2.0.0/24"]
    },
    {
      region         = "eu-central-1"
      cidr           = "10.3.0.0/16"
      public_subnets = ["10.3.0.0/24"]
    }
  ]

  firewall_rules = [
    {
      name    = "postgres"
      port    = 5432
      sources = ["192.0.2.44/32"]
    },
  ]

  depends_on = [pgedge_cloud_account.example]
}

# Database Resource
resource "pgedge_database" "example_db" {
  name       = "exampledb"
  cluster_id = pgedge_cluster.example.id

  options = [
    "autoddl:enabled",
  ]

  extensions = {
    auto_manage = true
    requested = [
      "postgis",
      "vector"
    ]
  }

  nodes = {
    n1 = {
      name = "n1"
    },
    n2 = {
      name = "n2"
    },
    n3 = {
      name = "n3"
    }
  }

  backups = {
    provider = "pgbackrest"
    config = [
      {
        id        = "default"
        schedules = [
          {
            type            = "full"
            cron_expression = "0 6 * * ?"
            id              = "daily-full-backup"
          },
          {
            type            = "incr"
            cron_expression = "0 * * * ?"
            id              = "hourly-incr-backup"
          }
        ]
      }
    ]
  }

  depends_on = [pgedge_cluster.example]
}
```

For more information on the available resources and their configurations, please refer to the documentation for each resource and data source.

## Example Usage

```terraform
provider "pgedge" {
  base_url = "https://api.pgedge.com" // (Optional) The base URL of the pgedge API.
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `base_url` (String) Base Url to use when connecting to the PgEdge service.
