paths:
  /clusters:
    get:
      summary: Get All Clusters
      description: Retrieve a list of clusters with optional limit and offset
      parameters:
        - name: Authorization
          in: header
          type: string
          format: Bearer {access_token}
          required: true
        - name: limit
          in: query
          type: integer
          format: int32
          description: Number of clusters to retrieve (default is 10)
        - name: offset
          in: query
          type: integer
          format: int32
          description: Offset for pagination (default is 0)
      responses:
        "200":
          description: Successful response
          schema:
            type: array
            items:
              $ref: "#/definitions/ClusterDetails"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/Error"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/Error"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/Error"

    post:
      summary: Create a new Cluster
      description: Create a new cluster with the specified options
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: Authorization
          in: header
          type: string
          format: Bearer {access_token}
          required: true
        - in: body
          name: body
          description: Cluster creation request body
          required: true
          schema:
            $ref: "#/definitions/ClusterCreationRequest"
      responses:
        "200":
          description: Successful response
          schema:
            $ref: "#/definitions/ClusterCreationResponse"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/Error"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/Error"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/Error"

  /clusters/{id}:
    get:
      summary: Get Cluster by ID
      description: Retrieve detailed information about a specific cluster
      parameters:
        - name: id
          in: path
          type: string
          format: uuid
          required: true
        - name: Authorization
          in: header
          type: string
          format: Bearer {access_token}
          required: true
      responses:
        "200":
          description: Successful response
          schema:
            $ref: "#/definitions/ClusterDetails"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/Error"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/Error"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/Error"

    delete:
      summary: Delete Cluster by ID
      description: Delete the cluster with the specified ID
      parameters:
        - name: id
          in: path
          type: string
          format: uuid
          required: true
        - name: Authorization
          in: header
          type: string
          format: Bearer {access_token}
          required: true
      responses:
        "204":
          description: No Content (successful deletion)
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/Error"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/Error"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/Error"
          
          
    patch:
      summary: Update Cluster by ID
      description: Update the cluster with the specified ID
      parameters:
        - name: id
          in: path
          type: string
          format: uuid
          required: true
        - name: Authorization
          in: header
          type: string
          format: Bearer {access_token}
          required: true
        - in: body
          name: body
          description: Cluster update request body
          required: true
          schema:
            $ref: "#/definitions/ClusterUpdateRequest"
      responses:
        "200":
          description: Successful response
          schema:
            $ref: "#/definitions/ClusterDetails"
        "400":
          description: Bad Request
          schema:
            $ref: "#/definitions/Error"
        "401":
          description: Unauthorized
          schema:
            $ref: "#/definitions/Error"
        "500":
          description: Internal Server Error
          schema:
            $ref: "#/definitions/Error"

definitions:
  ClusterCreationRequest:
    type: object
    properties:
      name:
        type: string
      regions:
        type: array
        items:
          type: string
      node_location:
        type: string
      cloud_account:
        type: object
        properties:
          id:
            type: string
            format: uuid
          name:
            type: string
          type:
            type: string
      cloud_account_id:
        type: string
      firewall_rules:
        type: array
        items:
          $ref: "#/definitions/FirewallRule"
      networks:
        type: array
        items:
          $ref: "#/definitions/Network"
      nodes:
        type: array
        items:
          $ref: "#/definitions/ClusterNode"
      resource_tags:
        type: object
        additionalProperties:
          type: string
      ssh_key_id:
        type: string

  ClusterCreationResponse:
    type: object
    properties:
      id:
        type: string
        format: uuid
      name:
        type: string
      status:
        type: string
      created_at:
        type: string
        format: date-time
      regions:
        type: array
        items:
          type: string
      cloud_account:
        type: object
        properties:
          id:
            type: string
          name:
            type: string
          type:
            type: string
      node_location:
        type: string
      firewall_rules:
        type: array
        items:
          $ref: "#/definitions/FirewallRule"
      networks:
        type: array
        items:
          $ref: "#/definitions/Network"
      nodes:
        type: array
        items:
          $ref: "#/definitions/ClusterNode"
      resource_tags:
        type: object
        additionalProperties:
          type: string
      ssh_key_id:
        type: string

  ClusterDetails:
    type: object
    properties:
      id:
        type: string
        format: uuid
      name:
        type: string
      status:
        type: string
      created_at:
        type: string
        format: date-time
      regions:
        type: array
        items:
          type: string
      cloud_account:
        type: object
        properties:
          id:
            type: string
            format: uuid
          name:
            type: string
          type:
            type: string
      node_location:
        type: string
      firewall_rules:
        type: array
        items:
          $ref: "#/definitions/FirewallRule"
      networks:
        type: array
        items:
          $ref: "#/definitions/Network"
      nodes:
        type: array
        items:
          $ref: "#/definitions/ClusterNode"
      resource_tags:
        type: object
        additionalProperties:
          type: string
      ssh_key_id:
        type: string

  ClusterNode:
    type: object
    properties:
      region:
        type: string
      availability_zone:
        type: string
      image:
        type: string
      instance_type:
        type: string
      name:
        type: string
      options:
        type: array
        items:
          type: string
      volume_iops:
        type: integer
      volume_size:
        type: integer
      volume_type:
        type: string

  FirewallRule:
    type: object
    properties:
      port:
        type: integer
      sources:
        type: array
        items:
          type: string
      name:
        type: string

  Network:
    type: object
    properties:
      region:
        type: string
      cidr:
        type: string
      external:
        type: boolean
      external_id:
        type: string
      name:
        type: string
      private_subnets:
        type: array
        items:
          type: string
      public_subnets:
        type: array
        items:
          type: string

  ClusterUpdateRequest:
    type: object
    properties:
      regions:
        type: array
        items:
          type: string
      firewall_rules:
        type: array
        items:
          $ref: "#/definitions/FirewallRule"
      networks:
        type: array
        items:
          $ref: "#/definitions/Network"
      nodes:
        type: array
        items:
          $ref: "#/definitions/ClusterNode"
      resource_tags:
        type: object
        additionalProperties:
          type: string
      ssh_key_id:
        type: string

  Error:
    type: object
    properties:
      code:
        type: integer
      message:
        type: string